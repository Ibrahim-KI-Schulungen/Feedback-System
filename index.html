<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Feedback zur Schulung | KI Schulungen</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: linear-gradient(145deg, #f0f7fb 0%, #f8fafc 50%, #f0f4f8 100%);
      min-height: 100vh;
    }
    
    /* Header Banner */
    .header {
      background: linear-gradient(135deg, #1388C6 0%, #0a5a8a 100%);
      padding: 40px 20px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    /* Decorative elements */
    .header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -10%;
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      border-radius: 50%;
    }
    
    .header::after {
      content: '';
      position: absolute;
      bottom: -30%;
      left: -5%;
      width: 300px;
      height: 300px;
      background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, transparent 70%);
      border-radius: 50%;
    }
    
    .header-content {
      max-width: 600px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }
    
    /* Professional Brand Text */
    .brand {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
      padding: 8px 16px;
      background: rgba(255,255,255,0.15);
      border-radius: 30px;
      backdrop-filter: blur(10px);
    }
    
    .brand-icon {
      width: 32px;
      height: 32px;
      background: #fff;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: #1388C6;
      font-size: 18px;
    }
    
    .brand-text {
      color: #fff;
      font-size: 15px;
      font-weight: 600;
      letter-spacing: 0.3px;
    }
    
    .brand-text span {
      font-weight: 400;
      opacity: 0.9;
    }
    
    .header h1 {
      color: #fff;
      font-size: 26px;
      font-weight: 700;
      margin-bottom: 10px;
      letter-spacing: -0.3px;
    }
    
    .header .schulung-name {
      color: rgba(255,255,255,0.9);
      font-size: 16px;
      font-weight: 500;
    }
    
    /* Container */
    .container {
      max-width: 640px;
      margin: 0 auto;
      padding: 32px 20px 60px;
    }
    
    /* Cards */
    .card {
      background: #fff;
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 20px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.04), 0 8px 24px rgba(19, 136, 198, 0.06);
      border: 1px solid rgba(19, 136, 198, 0.06);
    }
    
    .card.form-card {
      padding: 28px;
    }
    
    .card h2 {
      font-size: 17px;
      font-weight: 600;
      color: #0a5a8a;
      margin-bottom: 24px;
      padding-bottom: 14px;
      border-bottom: 2px solid #e8f4fc;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .card h2::before {
      content: '';
      width: 4px;
      height: 20px;
      background: linear-gradient(180deg, #1388C6, #0a5a8a);
      border-radius: 2px;
    }
    
    .intro-text {
      font-size: 15px;
      color: #4b5563;
      line-height: 1.7;
      margin-bottom: 10px;
    }
    
    .intro-text:last-child {
      margin-bottom: 0;
    }
    
    /* Form Elements */
    .form-group {
      margin-bottom: 26px;
    }
    
    .form-group:last-child {
      margin-bottom: 0;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 12px;
      font-size: 14px;
      font-weight: 500;
      color: #1f2937;
      line-height: 1.5;
    }
    
    .required {
      color: #dc2626;
      margin-left: 2px;
    }
    
    /* Star Rating */
    .star-rating {
      display: flex;
      gap: 2px;
      align-items: center;
    }
    
    .star-rating button {
      background: none;
      border: none;
      cursor: pointer;
      padding: 6px 8px;
      font-size: 26px;
      color: #d4d4d8;
      transition: all 0.12s ease;
    }
    
    .star-rating button:hover {
      transform: scale(1.15);
    }
    
    .star-rating button.active {
      color: #1388C6;
    }
    
    .star-rating button.hover {
      color: #1388C6;
      opacity: 0.7;
    }
    
    .star-rating .rating-value {
      margin-left: 14px;
      color: #6b7280;
      font-size: 13px;
      font-weight: 500;
      min-width: 35px;
    }
    
    /* Yes/No Toggle */
    .toggle-group {
      display: flex;
      gap: 10px;
    }
    
    .toggle-btn {
      padding: 11px 28px;
      border-radius: 10px;
      border: 2px solid #e5e7eb;
      background: #fff;
      color: #6b7280;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s ease;
      font-size: 14px;
    }
    
    .toggle-btn:hover {
      border-color: #1388C6;
      color: #1388C6;
    }
    
    .toggle-btn.active {
      border-color: #1388C6;
      background: linear-gradient(135deg, #e8f4fc 0%, #f0f9ff 100%);
      color: #0a5a8a;
    }
    
    /* Textarea */
    textarea {
      width: 100%;
      padding: 14px 16px;
      border-radius: 12px;
      border: 2px solid #e5e7eb;
      font-size: 14px;
      font-family: inherit;
      resize: vertical;
      transition: all 0.15s ease;
      outline: none;
      line-height: 1.6;
    }
    
    textarea:focus {
      border-color: #1388C6;
      box-shadow: 0 0 0 3px rgba(19, 136, 198, 0.1);
    }
    
    textarea::placeholder {
      color: #9ca3af;
    }
    
    /* Error Message */
    .error-message {
      background: linear-gradient(135deg, #fef2f2 0%, #fff5f5 100%);
      border: 1px solid #fecaca;
      border-left: 4px solid #dc2626;
      border-radius: 10px;
      padding: 14px 18px;
      margin-bottom: 20px;
      color: #b91c1c;
      font-size: 14px;
      font-weight: 500;
      display: none;
    }
    
    .error-message.show {
      display: block;
    }
    
    /* Submit Button */
    .submit-btn {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #1388C6 0%, #0a5a8a 100%);
      color: #fff;
      border: none;
      border-radius: 14px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 4px 15px rgba(19, 136, 198, 0.35);
      letter-spacing: 0.2px;
    }
    
    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(19, 136, 198, 0.4);
    }
    
    .submit-btn:active {
      transform: translateY(0);
    }
    
    .submit-btn:disabled {
      background: linear-gradient(135deg, #93c5e4 0%, #a8d4ea 100%);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    /* Footer */
    .footer {
      text-align: center;
      margin-top: 40px;
      padding-top: 24px;
      border-top: 1px solid #e5e7eb;
    }
    
    .footer p {
      font-size: 14px;
      color: #6b7280;
      margin-bottom: 12px;
    }
    
    .footer-links {
      display: flex;
      justify-content: center;
      gap: 24px;
    }
    
    .footer-links a {
      color: #1388C6;
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      transition: color 0.15s ease;
    }
    
    .footer-links a:hover {
      color: #0a5a8a;
    }
    
    /* Success Screen */
    .success-screen {
      min-height: 100vh;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      background: linear-gradient(145deg, #f0f7fb 0%, #f8fafc 50%, #f0f4f8 100%);
    }
    
    .success-screen.show {
      display: flex;
    }
    
    .success-card {
      background: #fff;
      border-radius: 24px;
      padding: 50px 40px;
      text-align: center;
      max-width: 480px;
      box-shadow: 0 8px 40px rgba(19, 136, 198, 0.12);
    }
    
    .success-icon {
      font-size: 56px;
      margin-bottom: 20px;
    }
    
    .success-card h1 {
      font-size: 26px;
      color: #0a5a8a;
      margin-bottom: 14px;
      font-weight: 700;
    }
    
    .success-card p {
      font-size: 15px;
      color: #6b7280;
      line-height: 1.7;
      margin-bottom: 28px;
    }
    
    .success-card a {
      display: inline-block;
      padding: 14px 32px;
      background: linear-gradient(135deg, #1388C6 0%, #0a5a8a 100%);
      color: #fff;
      border-radius: 12px;
      text-decoration: none;
      font-weight: 600;
      font-size: 15px;
      transition: all 0.2s ease;
      box-shadow: 0 4px 15px rgba(19, 136, 198, 0.3);
    }
    
    .success-card a:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(19, 136, 198, 0.35);
    }
    
    .form-screen {
      display: block;
    }
    
    .form-screen.hide {
      display: none;
    }

    /* Demo Banner */
    .demo-banner {
      background: linear-gradient(135deg, #fef3c7 0%, #fef9c3 100%);
      border-bottom: 1px solid #fbbf24;
      padding: 12px 20px;
      text-align: center;
      font-size: 13px;
      color: #92400e;
      font-weight: 500;
    }
    
    .demo-banner strong {
      font-weight: 600;
    }
  </style>
</head>
<body>
  <!-- Success Screen -->
  <div class="success-screen" id="successScreen">
    <div class="success-card">
      <div class="success-icon">âœ¨</div>
      <h1>Vielen Dank!</h1>
      <p>Ihr Feedback wurde erfolgreich Ã¼bermittelt und hilft uns, unsere Schulungen kontinuierlich zu verbessern.</p>
      <a href="https://offene.kischulungen.com/">Weitere Schulungen entdecken â†’</a>
    </div>
  </div>

  <!-- Form Screen -->
  <div class="form-screen" id="formScreen">
    <!-- Demo Banner -->
    <div class="demo-banner">
      âš¡ <strong>Demo-Modus</strong> â€“ Diese Vorschau dient zum Testen der BenutzeroberflÃ¤che
    </div>

    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="brand">
          <div class="brand-icon">K</div>
          <div class="brand-text">KI <span>Schulungen</span></div>
        </div>
        <h1>Feedback zur Schulung</h1>
        <p class="schulung-name" id="schulungName">KI Workshop â€“ Demo</p>
      </div>
    </header>

    <!-- Main Content -->
    <main class="container">
      <!-- Intro Card -->
      <div class="card">
        <p class="intro-text">Vielen Dank fÃ¼r Ihre Teilnahme an unserer Schulung! ðŸ¤–</p>
        <p class="intro-text">Ihre RÃ¼ckmeldung hilft nicht nur uns, sondern auch dem Trainer, sich weiterzuentwickeln.</p>
      </div>

      <!-- Form -->
      <form id="feedbackForm">
        <!-- Bewertung Card -->
        <div class="card form-card">
          <h2>Bewertung der Schulung</h2>
          
          <div class="form-group">
            <label>Wie hat Ihnen die Schulung insgesamt gefallen?<span class="required">*</span></label>
            <div class="star-rating" data-field="frage1">
              <button type="button" data-value="1">â˜…</button>
              <button type="button" data-value="2">â˜…</button>
              <button type="button" data-value="3">â˜…</button>
              <button type="button" data-value="4">â˜…</button>
              <button type="button" data-value="5">â˜…</button>
              <span class="rating-value"></span>
            </div>
            <input type="hidden" name="frage1" value="0">
          </div>
          
          <div class="form-group">
            <label>Wie beurteilen Sie die fachliche Kompetenz des Trainers?<span class="required">*</span></label>
            <div class="star-rating" data-field="frage2">
              <button type="button" data-value="1">â˜…</button>
              <button type="button" data-value="2">â˜…</button>
              <button type="button" data-value="3">â˜…</button>
              <button type="button" data-value="4">â˜…</button>
              <button type="button" data-value="5">â˜…</button>
              <span class="rating-value"></span>
            </div>
            <input type="hidden" name="frage2" value="0">
          </div>
          
          <div class="form-group">
            <label>Wie beurteilen Sie die methodisch-didaktische Vermittlung?<span class="required">*</span></label>
            <div class="star-rating" data-field="frage3">
              <button type="button" data-value="1">â˜…</button>
              <button type="button" data-value="2">â˜…</button>
              <button type="button" data-value="3">â˜…</button>
              <button type="button" data-value="4">â˜…</button>
              <button type="button" data-value="5">â˜…</button>
              <span class="rating-value"></span>
            </div>
            <input type="hidden" name="frage3" value="0">
          </div>
          
          <div class="form-group">
            <label>Wirkte der Trainer souverÃ¤n im Umgang mit dem Thema?<span class="required">*</span></label>
            <div class="star-rating" data-field="frage4">
              <button type="button" data-value="1">â˜…</button>
              <button type="button" data-value="2">â˜…</button>
              <button type="button" data-value="3">â˜…</button>
              <button type="button" data-value="4">â˜…</button>
              <button type="button" data-value="5">â˜…</button>
              <span class="rating-value"></span>
            </div>
            <input type="hidden" name="frage4" value="0">
          </div>
          
          <div class="form-group">
            <label>Wie war die Interaktion mit den Teilnehmenden?<span class="required">*</span></label>
            <div class="star-rating" data-field="frage5">
              <button type="button" data-value="1">â˜…</button>
              <button type="button" data-value="2">â˜…</button>
              <button type="button" data-value="3">â˜…</button>
              <button type="button" data-value="4">â˜…</button>
              <button type="button" data-value="5">â˜…</button>
              <span class="rating-value"></span>
            </div>
            <input type="hidden" name="frage5" value="0">
          </div>
          
          <div class="form-group">
            <label>War die Schulung gut strukturiert und logisch aufgebaut?<span class="required">*</span></label>
            <div class="star-rating" data-field="frage6">
              <button type="button" data-value="1">â˜…</button>
              <button type="button" data-value="2">â˜…</button>
              <button type="button" data-value="3">â˜…</button>
              <button type="button" data-value="4">â˜…</button>
              <button type="button" data-value="5">â˜…</button>
              <span class="rating-value"></span>
            </div>
            <input type="hidden" name="frage6" value="0">
          </div>
        </div>

        <!-- Inhalt Card -->
        <div class="card form-card">
          <h2>Zum Inhalt</h2>
          
          <div class="form-group">
            <label>Welche Inhalte der Schulung haben Ihnen besonders gut gefallen?<span class="required">*</span></label>
            <textarea name="frage7" rows="3" placeholder="z.B. praktische Ãœbungen, Beispiele aus der Praxis..."></textarea>
          </div>
          
          <div class="form-group">
            <label>Wie hilfreich war der vermittelte Inhalt fÃ¼r Ihre Praxis?<span class="required">*</span></label>
            <div class="star-rating" data-field="frage8">
              <button type="button" data-value="1">â˜…</button>
              <button type="button" data-value="2">â˜…</button>
              <button type="button" data-value="3">â˜…</button>
              <button type="button" data-value="4">â˜…</button>
              <button type="button" data-value="5">â˜…</button>
              <span class="rating-value"></span>
            </div>
            <input type="hidden" name="frage8" value="0">
          </div>
          
          <div class="form-group">
            <label>WÃ¤ren Sie an einer weiterfÃ¼hrenden Schulung interessiert?<span class="required">*</span></label>
            <div class="toggle-group" data-field="frage9">
              <button type="button" class="toggle-btn" data-value="true">Ja</button>
              <button type="button" class="toggle-btn" data-value="false">Nein</button>
            </div>
            <input type="hidden" name="frage9" value="">
          </div>
        </div>

        <!-- Feedback Card -->
        <div class="card form-card">
          <h2>Ihr Feedback</h2>
          
          <div class="form-group">
            <label>VerbesserungsvorschlÃ¤ge</label>
            <textarea name="frage10" rows="3" placeholder="Was kÃ¶nnten wir besser machen?"></textarea>
          </div>
          
          <div class="form-group">
            <label>WÃ¼rden Sie die Schulung weiterempfehlen?<span class="required">*</span></label>
            <div class="toggle-group" data-field="frage11">
              <button type="button" class="toggle-btn" data-value="true">Ja</button>
              <button type="button" class="toggle-btn" data-value="false">Nein</button>
            </div>
            <input type="hidden" name="frage11" value="">
          </div>
          
          <div class="form-group">
            <label>Was mÃ¶chten Sie dem Trainer persÃ¶nlich mitgeben?</label>
            <textarea name="frage12" rows="3" placeholder="PersÃ¶nliche Nachricht an den Trainer..."></textarea>
          </div>
        </div>

        <!-- Error Message -->
        <div class="error-message" id="errorMessage">
          Bitte fÃ¼llen Sie alle Pflichtfelder aus.
        </div>

        <!-- Submit Button -->
        <button type="submit" class="submit-btn" id="submitBtn">
          Feedback absenden
        </button>
      </form>

      <!-- Footer -->
      <footer class="footer">
        <p>ðŸš€ Bleiben Sie mit uns in Kontakt</p>
        <div class="footer-links">
          <a href="https://linkedin.com/company/kischulungen" target="_blank">LinkedIn</a>
          <a href="https://kischulungen.com" target="_blank">Website</a>
        </div>
      </footer>
    </main>
  </div>

  <script>
    // ============================================
    // KONFIGURATION
    // ============================================
    const SUPABASE_URL = 'https://nzeqfkiaidskutgkpwcv.supabase.co';
    const SUPABASE_KEY = 'sb_publishable_vqPbUSeS-90xsssPPHlm1A_zKczD0g8';
    const DEMO_MODE = false;
    const urlParams = new URLSearchParams(window.location.search);
    const SCHULUNG_ID = urlParams.get('s') || 'nicht-gefunden';
    
    // ============================================
    // STAR RATING
    // ============================================
    document.querySelectorAll('.star-rating').forEach(rating => {
      const field = rating.dataset.field;
      const buttons = rating.querySelectorAll('button');
      const valueDisplay = rating.querySelector('.rating-value');
      const hiddenInput = document.querySelector(`input[name="${field}"]`);
      
      buttons.forEach((btn, index) => {
        btn.addEventListener('click', () => {
          const value = parseInt(btn.dataset.value);
          hiddenInput.value = value;
          valueDisplay.textContent = `${value}/5`;
          
          buttons.forEach((b, i) => {
            b.classList.toggle('active', i < value);
          });
        });
        
        btn.addEventListener('mouseenter', () => {
          const hoverValue = parseInt(btn.dataset.value);
          buttons.forEach((b, i) => {
            b.classList.toggle('hover', i < hoverValue && !b.classList.contains('active'));
          });
        });
      });
      
      rating.addEventListener('mouseleave', () => {
        buttons.forEach(b => b.classList.remove('hover'));
      });
    });
    
    // ============================================
    // TOGGLE BUTTONS
    // ============================================
    document.querySelectorAll('.toggle-group').forEach(group => {
      const field = group.dataset.field;
      const buttons = group.querySelectorAll('.toggle-btn');
      const hiddenInput = document.querySelector(`input[name="${field}"]`);
      
      buttons.forEach(btn => {
        btn.addEventListener('click', () => {
          buttons.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          hiddenInput.value = btn.dataset.value;
        });
      });
    });
    
    // ============================================
    // FORM SUBMIT
    // ============================================
    document.getElementById('feedbackForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const form = e.target;
      const errorEl = document.getElementById('errorMessage');
      const submitBtn = document.getElementById('submitBtn');
      
      const formData = {
        schulung_id: SCHULUNG_ID,
        frage1: parseInt(form.frage1.value) || 0,
        frage2: parseInt(form.frage2.value) || 0,
        frage3: parseInt(form.frage3.value) || 0,
        frage4: parseInt(form.frage4.value) || 0,
        frage5: parseInt(form.frage5.value) || 0,
        frage6: parseInt(form.frage6.value) || 0,
        frage7: form.frage7.value.trim(),
        frage8: parseInt(form.frage8.value) || 0,
        frage9: form.frage9.value === 'true' ? true : form.frage9.value === 'false' ? false : null,
        frage10: form.frage10.value.trim(),
        frage11: form.frage11.value === 'true' ? true : form.frage11.value === 'false' ? false : null,
        frage12: form.frage12.value.trim()
      };
      
      // Validation
      const requiredRatings = ['frage1', 'frage2', 'frage3', 'frage4', 'frage5', 'frage6', 'frage8'];
      const missingRatings = requiredRatings.filter(f => formData[f] === 0);
      
      if (missingRatings.length > 0 || formData.frage7 === '' || formData.frage9 === null || formData.frage11 === null) {
        errorEl.classList.add('show');
        errorEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
        return;
      }
      
      errorEl.classList.remove('show');
      submitBtn.disabled = true;
      submitBtn.textContent = 'Wird gesendet...';
      
      try {
        if (DEMO_MODE) {
          console.log('Demo Mode - Formulardaten:', formData);
          await new Promise(resolve => setTimeout(resolve, 1000));
        } else {
          const response = await fetch(`${SUPABASE_URL}/rest/v1/feedback`, {
            method: 'POST',
            headers: {
              'apikey': SUPABASE_KEY,
              'Authorization': `Bearer ${SUPABASE_KEY}`,
              'Content-Type': 'application/json',
              'Prefer': 'return=minimal'
            },
            body: JSON.stringify(formData)
          });
          
          if (!response.ok) throw new Error('Fehler beim Senden');
        }
        
        document.getElementById('formScreen').classList.add('hide');
        document.getElementById('successScreen').classList.add('show');
        window.scrollTo(0, 0);
        
      } catch (err) {
        console.error(err);
        errorEl.textContent = 'Fehler beim Senden. Bitte versuchen Sie es erneut.';
        errorEl.classList.add('show');
        submitBtn.disabled = false;
        submitBtn.textContent = 'Feedback absenden';
      }
    });
  </script>
</body>
</html>
